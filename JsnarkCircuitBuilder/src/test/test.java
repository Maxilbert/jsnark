package test;

import java.math.BigInteger;
import java.util.Random;

import yuan.util.RSAKeyComponents;
import yuan.util.RSAKeyGenerator;
import yuan.util.RSAOAEPAlgorithms;

public class test {

	private final static int RADIX_BITS = 4;
	private final static int RADIX = (int) Math.pow(2, RADIX_BITS);

	private final static int BIT_WIDTH = 64;
	private final static int CHAR_WIDTH = BIT_WIDTH / RADIX_BITS;
	private final static int ENC_BITS = 2048;

	private final static int OAEP_BIT_WIDTH = 32;
	private final static int RND_BITS = 256;
	private final static int MSG_BITS = ENC_BITS - RND_BITS;
	
	private final static int P_Q_LEN = ENC_BITS / BIT_WIDTH / 2;
	private final static int B_D_N_LEN = ENC_BITS / BIT_WIDTH;
	private final static int NRE_LEN = ENC_BITS / BIT_WIDTH + 2;
	
	
	public static void main(String[] args){
		
//		BigInteger[] pIn = new BigInteger[P_Q_LEN]; 
//		BigInteger[] qIn = new BigInteger[P_Q_LEN];
//		BigInteger[] dIn = new BigInteger[B_D_N_LEN]; 
//		BigInteger[] nIn = new BigInteger[B_D_N_LEN]; 
//		BigInteger[] nReIn = new BigInteger[NRE_LEN]; 
//		BigInteger[] eIn = new BigInteger[1]; 
//		BigInteger[] tIn = new BigInteger[1];
//		
//		while(true){
//			Random rnd = new Random();
//			RSAKeyGenerator rsaKeyGenerator = new RSAKeyGenerator(ENC_BITS, rnd);
//			RSAKeyComponents rsaKeyComponents = RSAOAEPAlgorithms.generateRSAKeyComponents(rsaKeyGenerator, pIn, qIn, dIn, nIn, nReIn, eIn, tIn);
//			System.out.println(rsaKeyComponents.p.toString(16));
//			System.out.println(rsaKeyComponents.q.toString(16));
//			System.out.println(rsaKeyComponents.n.toString(16));
//		}
		int count = 0;
//		while(true){
//			count++;
//			Random random = new Random(System.currentTimeMillis()%1000 + count);
//			BigInteger prime = BigInteger.probablePrime(1024, random);
//			if (prime.compareTo(new BigInteger("2").pow(1016).multiply(new BigInteger("fc",16))) == 1){
//				System.out.println(prime.toString(16));
//			}
//		}
		String[] p = {
			"fe27650b5653746c1e3b5baa756511fcf4874c013d6a88f392f658645c2a6acfbc4e3e492e00d47ba1abe9c41730cf49eddfc001a1f3cbbbfb8e21e4c8e253e9f8335a965766004d267e511a490f93b6b0e1611f8862c76aa20e0ce380ada0a60bbc2baf5e1fd07f4eeb4927f77b9da82908187ca69841e30a24ac31ab40b3d1",	
			"fbc30ebf1ad5601fe1edfdc24fe2b1963a57baea80e3c22ce09deb9228d421707739c6ac271f94ff3051c93b6e3e7345e71c6117dd0be39815be977641a99d8c70e443438a5b6105336ba48baeb5ab715bb74495dd09a76263cc218eecdbd54b471c5b00270e191ccad86344e34994a0604fd6fb86c76e21286e0727eda5132d",
			"faa045aa56c02a8c6974397288d5b1b71b3be629f8cfb3a8801d9de7d321c07532503d7649ccc363800ebe074125979b64f6bb6b06d3987de448171766f82f41281d4ce1dd5565b9ce316ad6b698d90f3f0793f5553f1f81171f461703f21fafe1ef8c3dee0122f8a721d371437c5bbb384f213087f5bfb107a1ce6a97717c7b",
			"f2f68aa533911ddde9ebb1897c6a7a12b9893d0b83b8c6236c913f1641d2d007eaecbd905f9e6a289a571ab85c3f161292de9d62a1318ef7666afea5748f22db5e5cb2abec545dd514126ca547ae25d8cd2dd38d58a5c6330b9f2220ee764e1e25e6fb3d55873ab9eebe3d4365e527c3aa9126e4c89d53ccec8e2ade4b5cde17",
			"f79752e4361c4313b579e0c3ca24c52e1768fe2f23094fbfb8e0fe6339a9e32a78c9a8628c5215f5a636ca73c1eb58259df4e49d3a44e3424d4b6f8cd76176285b9c83547c246c61b350f1b319762241be18b2303b4fc771a15a1f5d7e6ba0102cdc26484c6ecc5a64d2e3c7cebf16e1cb96bdf005638aefd2e230e455c1f541",
			"facec72eb544048d731185c00fc717321e9dc2b2ac7f8b0c36e8b2b52dc7f99f30d673f3ae8ae8a098c38bcad0c6a5323d020b6b3098b0ab66afdd5a468481116b7ed624fa28754f60dc81427d1eb64ebc4500501bd6a8091cd527b622726a41948a77401c46b2f32b9da424eab39d7778e41bed78c11c6f791ef29f2edc6343",
			"f5d613a94dc4cf8e709e3fc2d362c310966292d0a95836ea8f39f78689943884fd97f9a38a339d9eb9f11eae1179c6786de101cf2df11964eeb4ede7021276f9ce59f2472da59bd3f524fa4a4af0c36844a11043048c684d91c4eb82522b9d547d6f90c8d2d006cbf243f59a602612a04a7739c35d6bc54a6ea042e23dc8a673",
			"fda9d663c23b549397d4da0c505fa9eee111ca094df16a2e3259a20a143dbc194f578f3a9ca05d3ca8da04f0a0c317251c9c602b4dae7852104b89bd20e940f96b89ef3de24bc0da2febf839de97b83ec2e6ea76c7f970a52e3e96aee72945a2da968dc992a577778c04235aee7ae51eb50d602c8ce856e3557256da6fb4caeb",
			"ffd30fb71f5382021b4c5ef0920cbbaf9c8eba1e8b9f466c781ee0f481bb4f7cfce67cd74aa7fc8f825c170a1df95dc01e3ebaf3b124d41f988f537a43fd6f19f32929638532a8fcd31069c5c6fa96c67ca52eabd259b6b146647e5b5e138accb1272994fa28588686843d85df162c32a4c41b7410a8d6cd6ce2cf70ad81532b",
			"fd0ecf31407b852d1f020a962d9bb16f0ae6e1be45779542dd9001b5b9a40c9a11be724144dc3b475def308c7e73d21ae3f6f1fa4f16ae838042e87ae2942cbdf1fae0af8da790a8b22db22e8479a9b1b6964895516c81fb72c7cced6c291bd1d46a6217688cf99a12d29ece848730d77ddc6446b2ad4c5fbb3c41c447d89c53",
			"f4e9f4fd6f95fff60e0024ec93bed0dd9dc62775fb1463b28ddd4b7a8180ad3b1f3f92a711c76113e78acb89eb0ea78a90e41c35f1ac1b95981598ff98f9ed5bdb8d4ebc3bfe88872945de9adfd5385c40f02554a4e749f8d685bca07e7eec019e44058ce70027b37059ded1a9fce791f47c5ce0f8ad4ea88472e3cb666efdbd"
		};
		String[] q = {
			"f89e579f27d48d7a4bd542a067e8d4d1192bb58873fcd455634dffd220901af04c766ee68f9020f45843d5455f3ec5e3135b2bab13832671530afdb036f522b2e815339001ea198af5cb74699244ef5f4978aae7f5851ffa77d1062c8cc6e6ad775083de9a08274513bb083cfe8c25c4790994a660ce6dd9a249cc6459548745",
			"f4dcd7f3849edda2844f474335c427ed1160266e89aa4d4c6a4167e139f4ae5d9a54ec2a9310d753a977e79aa496c3f2363c76819e7d4bc2f351226649f80423bad8e17ec32fdbf85d277a13e219df055f2fb312e141cb0f31d31c5c561ec4f8b49309a0798dd20203bbb22e3ed99777d6ed259fda4648ea02a2af11a5416d61",
			"f71569d034d69cd24ae072cbaecbe070a35301ccd61206ff921105410c8ae820673221c16a91277b817d2ac93b9b99420099b49665d012f1e9a3e3d94af366bcfdb855ebaff58743c5f5d1a6a3aac8a6b420050d85ab668c46baea37907fa7367a78fc3c9f6755d72bb1caf9016c40d20d5fd315958073905506f14e8c538787",
			"fdf58ea199542e6ee7b670148d2733d06925d53cdfe56c6a939d8f75c868438d749e0f45255c2d950c99905b34e44d1dcc123706bab7927735e2a8f881666ec95f43088d5f4abcfb656bc8681871c48b106d8c3ae4b7751d367e4ddc5de529f5a74c6f8b13dd534e9ce2f3c133a0924308ee1c5acdc07e8039e3a652c4c9d01b",
			"fc9ea6590d11d81d3e1c85a621b4bb62512e793e6bf26c5d622d11256aebaeca88a2af0bc021e9e6649ad8afd6af961ac503e4aa7348fd2f2fd0f4ba7b1d2ec2fdb61604764434a6ec4fee85950fb5c25cc839ba4ee3badd844e4b47bda3aae369806b3c72ba7f3e6248eac45a3cd02267a76206d9b0078f7d8d8b9057b6360b",
			"fdd351883367265437595d259d3fc452109405d4ccd6f0e1248042fe9e251b909c552674f91401af05227d1b57cb7c8101e59621bf13edc1f83a083f22211919345077ef757c29560ba1a6380189daf307803b76bb090cc52689a4bdad43604eada1bb06ab0c45c027f63160ee1a8a437d2423a44e914f5d4e76d2612ddd63f9",
			"fa2f5fd1bd1e6215e191f90f40f3767ba891e13286516892020240fd6c213a3e83fd4216691a241fa45f593c097f2b94b2905de35e15a042f89606c5f8348eaa9e9cbfc65a57eea817b9f49111e607e50d9efbc8d199a006351bb00746b01dfd701118cb7c1a99a217b54d8c089c1d6b78b837545c33a391c272a79be91d30f1",
			"f9a40d42e77aa15fbcdaf96bb46cbce1bfac41bc5a2bdfb152cae8dc8b8330a7abe24527534376819021710c70dadcfa8ae1ff30ae75b733f2d66250faea5831551c806e0a28a1e003508a5dc42b0eb8c62b6fa5d2728ca612fb0cd2083aadfa2ee1895d7b9d5b48255089d98679997e85324b5d0a9b5de62e6d8189aa4e96ab",
			"f530e19fcb71dd41c34298b63b307aa402444be2e377e5295f3565f4c8420c37d4c7a7a131fd1eaa7d401e364d12be706082a469edef099990dd07d92d0786bbca494f99007946eb05c3c113fd8855c288a89bb0da6d97c683d305087bf60b1545a88b96828bb9c9743dd086bea88c3f07e75f40eece0a24c48e6bc1af755949",
			"f5c872c2440bafe967aa41efaa04e9a125dd45c01df08e9b01c0e4957b12a22d5adca38bad06210d7535399e25a6b649184a11fd053d983bcabc71543e8a9e3b69f1be812bf95359f4720d207251b641bbb2faea2e9b1200563aa786b7788bfa08cc44707a8c01ec87b90139c4f88b8e37ffaeda6d70ee0b58020e4ac3fa9b83",
			"fbb6cbfd9a271f01009232ebb784510146703420ef83005477847f5dd3e84bdf906cc7ee2dc524351150e6eeb206c74f6e3d411a3c56897af921957a313f2425268413b3c20c97f9466e2da01f34b7a7394815fcd9cd145aa2c8fd820c5e3ae9a33a33a9024a531e2c236e6c67ab96df6069ca9d5804c4229f97b68bc77c9e45"
		};
		RSAKeyGenerator[] rsaPlayers = new RSAKeyGenerator[11];
		for (int i = 0; i < 11; i++){
			rsaPlayers[i] = new RSAKeyGenerator(new BigInteger(p[i],16), new BigInteger(q[i],16));
		}
		String pCA = "fc904278ac2f9c62c2788f8969437f003f962e8de3c3680bf9174c2e49a7cdf0d5ec5214c179e5733ef0fe55f460ba8695d14bb1c309eaccbb1e98dd7964fc157b54eaa9f6a01ceea57bc44b9e4b7e1608b84e03158d838ac0d6fd0d14b256fc676b6eb1d6157d9c28f8c34feca06dbed102fd3080174bf14d695eaa49bd48db";
		String qCA = "fd83db33c1cd2c10822719cf233773778923211ea8237a4cadab20197bb1baec72a378947d8e28f5817e6c1ca306814e9ca25ffafd8053794357f202b9234b60a969b8769a0497a6e0ef6517b7da36a3661407288e67ed307a1b729b9f103410e7f53c7e3238713323418e6bf41ae6caf09a939d8f21f3f7e73e6a4e6c003bff";
		RSAKeyGenerator rsaCA = new RSAKeyGenerator(new BigInteger(pCA,16), new BigInteger(qCA,16));
		BigInteger[] certificates = new BigInteger[11];
		for (int i = 0; i < 11; i++){
			System.out.println(rsaPlayers[i].getN().toString(16));
		}
		for (int i = 0; i < 11; i++){
			certificates[i] = rsaPlayers[i].getN().modPow(rsaCA.getD(), rsaCA.getN());
		}
		for (int i = 0; i < 11; i++) {
			System.out.println(certificates[i].modPow(new BigInteger("3"), rsaCA.getN()).equals(rsaPlayers[i].getN()));
			System.out.println(certificates[i].modPow(new BigInteger("3"), rsaCA.getN()).toString(16));
		}		
	}
	
	
}

//Player 0
//fc878cc1449a9e80418fa2c446c9c34c207b42f4ca6882b2a8261483293662656f2c46f08195a89a443febeb6f6e93439dc49b660b04c994676902943b8e33089532f1d5911d7c6b2f2da71b4de8a410b0eda10d3fd68006e79440ea97ca3ec9c3a0eddbf11559d5ad79e9b611780b575f01c0292e78779955765045c96b9203
//fc3c07b0a44b040b1e63ce4cda200c56c7814fa9f868394440ab892ce241a760db748cc7ec004a84d4b32704e1a45bd5402402635ecdb6232e33653704b41b78df2114cc5b8b62c040aea5ec5600e5c00dedfa6dd4b6bf35401c00f19a465763c778d78392cd71ff89a0ffe95a6df6ba3f52820d674dcb8bbe7e9b173fd050d3
//
//Player 1
//fbe631a410ba18dd6a59f1c86beb6fb35f9a51ef82f86d7e810b9ad40d7a46fa6b22e4ceb9798dfc64a3643b5e527a3647b99be684f7c327d6033a022f4a513cca7d3ee440e447e463be32c6f2585b494026cd7e45a0ff56c80df2bf480c55bb6e9b1b9aa31271889192cb44d831e413d2bf29c60e99450b04b6750362ca98ed
//ff61dfad611002552af9b83c8f5e96a3129ef244ed1b339f0e1a53b512d2fc4f850e4c94e29caddcfb9dca440500ff6dd18968c43f3bb5831fe216fd6b49bc2acb9bba30254f0e3651215f88699975ffce4c17ebaa39dcb454bee47d3a1cb8c6963f3560edf6cb655d6ed15665f107dc6e49658f6a3d8d5ed2075fdc324d4a93
//
//Player 2
//fef101c2c4b12c1f19549160bd182947a33e568c8bba5227150fcedd19a50e8f97b4cb88f0012105b359ad76dfd2c743cbc49bd43d187da6fd8a497a4b17639b68fdb77976ee98a9eafefc308a0ec2d7ce40dd9b16db3e0104cfe98a917176f5d8e8f4e8feb58c8e4af1b10c29151814655a4ec7aa3fb0ff56e157264e461459
//fda194a14b6788889e2aed1ca8d9940628f3e0f2b5599764e391a9024c9befbfed331e033fa978ea1c7345f11149e9ceab1e02da33510e763091a4e18656c25be32c1ea525d7d61bb85f964cc8cbcec0e432ae6d441e5edbbf752dacef3a7ef2271a7269f19b9735c9e8d45bcb18e977fc5d7eaa95c1ce7716d431e7cf6c108f
//
//Player 3
//fef101c2c4b12c1f19549160bd182947a33e568c8bba5227150fcedd19a50e8f97b4cb88f0012105b359ad76dfd2c743cbc49bd43d187da6fd8a497a4b17639b68fdb77976ee98a9eafefc308a0ec2d7ce40dd9b16db3e0104cfe98a917176f5d8e8f4e8feb58c8e4af1b10c29151814655a4ec7aa3fb0ff56e157264e461459
//fdec19b3eab522fec156c19414824cfd81ecd33d8659e0d24b0d3459938faac481ebd72bd53dd7008bfe08d99e12213d09bf9bdde18720e769c7413ebd30daeb993dfbae5b69f0c6a6de977bbeb38e108733550dae3d1fac66ee6da5edbe6558234288c151e47e0beec1be288123fe131b0dbcc65cec7a85adcbe61458085573
//
//Player 4
//fda194a14b6788889e2aed1ca8d9940628f3e0f2b5599764e391a9024c9befbfed331e033fa978ea1c7345f11149e9ceab1e02da33510e763091a4e18656c25be32c1ea525d7d61bb85f964cc8cbcec0e432ae6d441e5edbbf752dacef3a7ef2271a7269f19b9735c9e8d45bcb18e977fc5d7eaa95c1ce7716d431e7cf6c108f
//fcdf15c366cf2d7a13099c68e3f963a07eb084be11e1d5f9ad57691901dd6317c1e76b22f633ef589fe45bd64d2576f70292e8a34ce17df685b3709797cc12c272c06447910cc3ee6245206301c27938ed104fddab99b0c1fa7d7744c106c6c37105c6fa51a15f5b600a495624538f83cdde5c06a8474f16cd1cf643d5879821
//
//Player 5
//fea67cb0256392a9f627bde8527071504a456341b9ba09b9ad934387d2b0538a03fd11605b6dc2ee43cee98e520990d56d2402d190e16a35c454ac1d143d4b0bb2ecda6f405c7ffefc7ffb01942602882a4036fcacbb7d305d56a99193ed8e8fddc0de909f6da5b82518c83f730a037845ab10abe31404f2bfe9a2f8c5aace61
//fc3ebba532efa7d63bd3ea6c081c1007bccf93b9c970c1c5863cef6ae62048acbedd09012d18d4bac048d5253c095deaac86e823c6d47889f34da8058c8830f6a70bb25540d38e6796d6ab0da73230717e497a4eb2632f12daf6281a7248dcb51b00f4b8039e770e44232be4ec0c6840409dc6a289681d887b5c1b026fe69ba7
//
//Player 6
//fea67cb0256392a9f627bde8527071504a456341b9ba09b9ad934387d2b0538a03fd11605b6dc2ee43cee98e520990d56d2402d190e16a35c454ac1d143d4b0bb2ecda6f405c7ffefc7ffb01942602882a4036fcacbb7d305d56a99193ed8e8fddc0de909f6da5b82518c83f730a037845ab10abe31404f2bfe9a2f8c5aace61
//fc9644a7552437d00d4de410a44cb05a1a05d68310e9140d8c6d4401bec7495e11992f33a1b61a791cee45101bc03f9e1154356107b22deb11981609e9c60fb0849925c740c2d5eac9ee24555b0c0599bb6c271e1f275fcdeddf5f749b8463b0c964ccd762297e94f6b38a83ffe7eb6caf7a637f0338f504f302c1007b02aeb9
//
//Player 7
//fbe631a410ba18dd6a59f1c86beb6fb35f9a51ef82f86d7e810b9ad40d7a46fa6b22e4ceb9798dfc64a3643b5e527a3647b99be684f7c327d6033a022f4a513cca7d3ee440e447e463be32c6f2585b494026cd7e45a0ff56c80df2bf480c55bb6e9b1b9aa31271889192cb44d831e413d2bf29c60e99450b04b6750362ca98ed
//fef101c2c4b12c1f19549160bd182947a33e568c8bba5227150fcedd19a50e8f97b4cb88f0012105b359ad76dfd2c743cbc49bd43d187da6fd8a497a4b17639b68fdb77976ee98a9eafefc308a0ec2d7ce40dd9b16db3e0104cfe98a917176f5d8e8f4e8feb58c8e4af1b10c29151814655a4ec7aa3fb0ff56e157264e461459
//
//Player 8
//fea4c8ba98bfeeddd9b7a0c824756d9f54f71e31e9b281376602de48ced1b23e209494261a5638b857393c6df7a48ec001c21b1028daa8cffe39694f8c68368dea023de65b145357a657f5e043f4b6d7b9e3b61bce0e0e54c37b8068bbeb093d8839c25b2e9d9fa96a959c45e26a91f24360cc15c1f9b1f5020c230e9694784d
//fc7164c193bdea507783d9399ec2fc5911c6281d4109259fb39fcd4582d104fd28756cab9f026f4b4a2b35c814d3c18fbc58079dbfe07866b2dbc7e99190a68704fbc0646c1f75842effa6fa1d4a1b1ce596a05d92e880706434b284c2d8eec5a82b5886dc2fdf6e2d87b74cb86c2966ec97a0be9f64578eac06c8c1e66b56cd
//
//Player 9
//fea67cb0256392a9f627bde8527071504a456341b9ba09b9ad934387d2b0538a03fd11605b6dc2ee43cee98e520990d56d2402d190e16a35c454ac1d143d4b0bb2ecda6f405c7ffefc7ffb01942602882a4036fcacbb7d305d56a99193ed8e8fddc0de909f6da5b82518c83f730a037845ab10abe31404f2bfe9a2f8c5aace61
//fc3953ba17a8603f01f3b12cad2508a5d1330b992861b1c2f91924eede620615f80b0f8eabe9bf4de71e7ae287405ac0d3c11ba2f6c5f4bd681822697cdf06fa1738764276433619eb859fcb06ce99109b907b8df6095059a641d7c7c244d21073f1ba4e21fd6bf0cd1dd4efc9cd84353d073e784532798f01a11b2d10baefb7
//
//Player 10
//fc9490b1c7809304f0dcc7f07751aca924b791733fe18c8b45dcdec2bbe8a8122e30b2f9609f9042305998eec05b3e89a4f14ea09faa6b854b7dd33a60f2fa31bcaf873d5b7aa94373c61e340adab9e84a10a83d417aeff05305374bc382de5d75ddafa2f15878853b315f896e487ae7ad2f1feae11ca308362541164cec4c83
//ff6393a3eeb3a5204769d55cbd599a5408ec3655bd23bb2055abb8f315b19d9b6877c9cd23b43713e7327866606400833dec4e85a74277e9e4fc59cbf31dd1a8948558ba0a973adda64965a9b9cbc0af3fa996cb88e64b91ee980da7121e3d19eac651955ec7d17418f1fc50f79079617094a9248c58df5a8fe5dec661639e41
//
//
//CA
//ffac64bf005f9cca4d258db4fb064e9a6c97e58fbe1b7c0d7695dd0b58c6b75419c605bd77310cf36b298e2c92c936dc2f2a02c8ec71c7f45818b459a223d4ba81ac973a5be127e13fa060b76081354f714dbe8a15599d85fb36257737a09f2c92674bb84d3fb33b8147bb231cfc1c788ef8a2ab3168396c69ff130abbe88fed
//ff6647997c5749ec64d9f17cea549e05fe397b658d2b43a29b3c1e3219903ee74ce0460764cbc149d3c72588bbc80198a94e35460f4a394faa179d997bf2e5265c6ff643efde6684fc716bca0afe0b60b00516ac6693bb6d887336d0ea1fc26b3f4e6ecacf97d783d373284b8830ebe672dfedb9ae7331574cc35eb19079f591
//